<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Super Bowl LX 2026 Prop Bets Dashboard</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Oswald:wght@400;600;700&family=Roboto+Condensed:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --seahawks-blue: #002244;
            --seahawks-green: #69BE28;
            --seahawks-gray: #A5ACAF;
            --patriots-navy: #002244;
            --patriots-red: #C60C30;
            --patriots-silver: #B0B7BC;
            --bg-dark: #0a0e27;
            --bg-card: #1a1f3a;
            --text-primary: #ffffff;
            --text-secondary: #b8c5d6;
            --accent-glow: #69BE28;
            --gold: #ffd700;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto Condensed', sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1a1535 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .background-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.03;
            background-image: 
                repeating-linear-gradient(45deg, transparent, transparent 35px, rgba(255,255,255,.05) 35px, rgba(255,255,255,.05) 70px);
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        .header {
            text-align: center;
            padding: 30px 20px;
            margin-bottom: 30px;
            background: linear-gradient(135deg, rgba(198, 12, 48, 0.1) 0%, rgba(0, 34, 68, 0.1) 100%);
            border-radius: 20px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(0, 217, 255, 0.1) 0%, transparent 70%);
            animation: pulse 8s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.3; }
            50% { transform: scale(1.2); opacity: 0.6; }
        }

        .header h1 {
            font-family: 'Bebas Neue', cursive;
            font-size: clamp(2rem, 5vw, 4rem);
            letter-spacing: 3px;
            margin-bottom: 10px;
            background: linear-gradient(45deg, var(--patriots-red), var(--patriots-silver), var(--seahawks-blue), var(--seahawks-green));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 30px rgba(255, 255, 255, 0.3);
            position: relative;
            z-index: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .team-logo {
            width: clamp(50px, 8vw, 80px);
            height: clamp(50px, 8vw, 80px);
            object-fit: contain;
            filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.3));
            animation: float 3s ease-in-out infinite;
        }

        .team-logo.patriots {
            animation-delay: 0s;
        }

        .team-logo.seahawks {
            animation-delay: 1.5s;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .header-title-text {
            display: inline-block;
        }

        .header .subtitle {
            font-family: 'Oswald', sans-serif;
            font-size: clamp(1rem, 2.5vw, 1.5rem);
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 2px;
            position: relative;
            z-index: 1;
        }

        .stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--bg-card);
            padding: 20px;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 217, 255, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .stat-card:hover::before {
            left: 100%;
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 217, 255, 0.2);
            border-color: var(--accent-glow);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .stat-value {
            font-family: 'Oswald', sans-serif;
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent-glow);
        }

        .prize-value {
            color: var(--gold);
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab {
            flex: 1;
            min-width: 150px;
            padding: 15px 25px;
            background: var(--bg-card);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: var(--text-secondary);
            font-family: 'Oswald', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .tab:hover {
            border-color: var(--accent-glow);
            color: var(--text-primary);
        }

        .tab.active {
            background: linear-gradient(135deg, var(--patriots-red), var(--seahawks-blue));
            border-color: transparent;
            color: white;
            box-shadow: 0 5px 20px rgba(198, 12, 48, 0.4);
        }

        .leaderboard {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 30px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 30px;
        }

        .leaderboard-header {
            display: grid;
            grid-template-columns: 60px 1fr 100px 120px;
            gap: 15px;
            padding: 15px 20px;
            font-family: 'Oswald', sans-serif;
            font-size: 0.9rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 15px;
        }

        .leaderboard-row {
            display: grid;
            grid-template-columns: 60px 1fr 100px 120px;
            gap: 15px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 12px;
            margin-bottom: 10px;
            align-items: center;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }

        .leaderboard-row:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--accent-glow);
            transform: translateX(5px);
        }

        .rank {
            font-family: 'Bebas Neue', cursive;
            font-size: 2rem;
            text-align: center;
            color: var(--accent-glow);
        }

        .rank-1 { color: var(--gold); text-shadow: 0 0 20px rgba(255, 215, 0, 0.5); }
        .rank-2 { color: #C0C0C0; text-shadow: 0 0 20px rgba(192, 192, 192, 0.3); }
        .rank-3 { color: #CD7F32; text-shadow: 0 0 20px rgba(205, 127, 50, 0.3); }

        .player-name {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .points {
            font-family: 'Oswald', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            text-align: center;
            color: var(--accent-glow);
        }

        .percentage {
            text-align: center;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .prize-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .prize-card {
            background: linear-gradient(135deg, rgba(198, 12, 48, 0.1), rgba(0, 34, 68, 0.1));
            padding: 25px;
            border-radius: 15px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            text-align: center;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .prize-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(105, 190, 40, 0.3);
            border-color: var(--seahawks-green);
        }

        .prize-tooltip {
            position: absolute;
            bottom: 110%;
            left: 50%;
            transform: translateX(-50%) scale(0.9);
            background: var(--bg-card);
            border: 2px solid var(--seahawks-green);
            border-radius: 12px;
            padding: 15px;
            min-width: 250px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .prize-card:hover .prize-tooltip {
            opacity: 1;
            transform: translateX(-50%) scale(1);
            pointer-events: auto;
        }

        .prize-tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 8px solid transparent;
            border-top-color: var(--seahawks-green);
        }

        .prize-tooltip-title {
            font-family: 'Oswald', sans-serif;
            font-size: 0.9rem;
            color: var(--seahawks-green);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .prize-tooltip-player {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .prize-tooltip-player-name {
            color: var(--text-primary);
        }

        .prize-tooltip-player-amount {
            color: var(--gold);
            font-weight: 600;
        }

        .prize-tooltip-total {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            font-weight: 700;
            font-size: 0.95rem;
        }

        .prize-tooltip-total-label {
            color: var(--text-primary);
        }

        .prize-tooltip-total-amount {
            color: var(--gold);
        }

        .prize-place {
            font-family: 'Oswald', sans-serif;
            font-size: 0.9rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }

        .prize-amount {
            font-family: 'Bebas Neue', cursive;
            font-size: 2.5rem;
            color: var(--gold);
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
            margin-bottom: 5px;
        }

        .prize-winners {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .trends-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .trend-card {
            background: var(--bg-card);
            padding: 20px;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .trend-question {
            font-size: 0.95rem;
            color: var(--text-primary);
            margin-bottom: 15px;
            font-weight: 600;
            line-height: 1.4;
        }

        .trend-option {
            margin-bottom: 12px;
        }

        .trend-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .trend-name {
            color: var(--text-secondary);
        }

        .trend-percent {
            color: var(--accent-glow);
            font-weight: 600;
        }

        .trend-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .trend-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--patriots-red), var(--seahawks-blue));
            transition: width 0.5s ease;
            border-radius: 4px;
        }

        .chat-container {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 25px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            height: 600px;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 20px;
            padding-right: 10px;
        }

        .chat-messages::-webkit-scrollbar {
            width: 8px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: var(--accent-glow);
            border-radius: 4px;
        }

        .chat-message {
            background: rgba(255, 255, 255, 0.05);
            padding: 12px 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 3px solid var(--accent-glow);
        }

        .chat-author {
            font-weight: 700;
            color: var(--accent-glow);
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .chat-text {
            color: var(--text-primary);
            font-size: 0.95rem;
            line-height: 1.4;
        }

        .chat-time {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        .chat-input-container {
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            color: var(--text-primary);
            font-size: 0.95rem;
            font-family: 'Roboto Condensed', sans-serif;
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--accent-glow);
            box-shadow: 0 0 15px rgba(0, 217, 255, 0.2);
        }

        .chat-button {
            padding: 12px 25px;
            background: linear-gradient(135deg, var(--patriots-red), var(--seahawks-blue));
            border: none;
            border-radius: 10px;
            color: white;
            font-family: 'Oswald', sans-serif;
            font-size: 0.95rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .chat-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(198, 12, 48, 0.4);
        }

        .chat-button:active {
            transform: translateY(0);
        }

        .loading {
            text-align: center;
            padding: 50px;
            font-size: 1.2rem;
            color: var(--text-secondary);
        }

        .error {
            background: rgba(198, 12, 48, 0.2);
            border: 2px solid var(--patriots-red);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .update-indicator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px 20px;
            background: var(--bg-card);
            border: 1px solid var(--accent-glow);
            border-radius: 25px;
            font-size: 0.85rem;
            color: var(--accent-glow);
            box-shadow: 0 5px 20px rgba(0, 217, 255, 0.3);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .full-results-table {
            overflow-x: auto;
            margin-top: 20px;
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }

        .results-table th {
            background: rgba(255, 255, 255, 0.05);
            padding: 12px 8px;
            text-align: left;
            font-family: 'Oswald', sans-serif;
            text-transform: uppercase;
            font-size: 0.8rem;
            letter-spacing: 0.5px;
            color: var(--text-secondary);
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
            position: sticky;
            top: 0;
            cursor: pointer;
            user-select: none;
            transition: all 0.2s ease;
        }

        .results-table th:hover {
            background: rgba(105, 190, 40, 0.1);
            color: var(--seahawks-green);
        }

        .results-table th.sortable::after {
            content: ' ‚áÖ';
            opacity: 0.3;
        }

        .results-table th.sorted-asc::after {
            content: ' ‚ñ≤';
            opacity: 1;
            color: var(--seahawks-green);
        }

        .results-table th.sorted-desc::after {
            content: ' ‚ñº';
            opacity: 1;
            color: var(--seahawks-green);
        }

        .question-cell {
            position: relative;
            cursor: help;
        }

        .question-tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(-5px);
            background: var(--bg-card);
            border: 2px solid var(--seahawks-green);
            border-radius: 8px;
            padding: 12px;
            min-width: 200px;
            max-width: 300px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
            opacity: 0;
            pointer-events: none;
            transition: all 0.2s ease;
            z-index: 1000;
            white-space: normal;
            text-align: left;
        }

        .question-cell:hover .question-tooltip {
            opacity: 1;
            transform: translateX(-50%) translateY(-10px);
        }

        .question-tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: var(--seahawks-green);
        }

        .question-tooltip-title {
            font-weight: 600;
            color: var(--seahawks-green);
            margin-bottom: 8px;
            font-size: 0.85rem;
            line-height: 1.3;
        }

        .question-tooltip-result {
            color: var(--text-primary);
            font-size: 0.8rem;
            padding-top: 8px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .question-tooltip-result-label {
            color: var(--text-secondary);
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }

        .question-tooltip-pending {
            color: var(--text-secondary);
            font-style: italic;
            font-size: 0.75rem;
        }

        .results-table td {
            padding: 10px 8px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .results-table tr:hover {
            background: rgba(255, 255, 255, 0.02);
        }

        .correct-pick {
            color: #4ade80;
            font-weight: 600;
        }

        .incorrect-pick {
            color: #f87171;
        }

        .pending-pick {
            color: var(--text-secondary);
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .leaderboard-header,
            .leaderboard-row {
                grid-template-columns: 50px 1fr 80px;
                gap: 10px;
            }

            .percentage {
                display: none;
            }

            .header {
                padding: 20px 15px;
            }

            .stat-card {
                padding: 15px;
            }

            .stat-value {
                font-size: 1.5rem;
            }

            .trends-grid {
                grid-template-columns: 1fr;
            }

            .tabs {
                flex-direction: column;
            }

            .tab {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="background-pattern"></div>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // ============================================
        // CONFIGURATION - UPDATE THESE VALUES
        // ============================================
        const CONFIG = {
            // Replace with your Google Apps Script Web App URL
            SHEET_API_URL: 'https://script.google.com/macros/s/AKfycbzDoPq8f4lX7riZIeep98lY6X67MdtDKBSZb1vsON8CBDuAg8AwXXmXM9Jf-UUvApBy/exec',
            
            // Refresh interval in milliseconds (5 seconds)
            REFRESH_INTERVAL: 5000,
            
            // Chat configuration
            CHAT_ENABLED: true,
            CHAT_SHEET_URL: 'https://script.google.com/macros/s/AKfycbzDoPq8f4lX7riZIeep98lY6X67MdtDKBSZb1vsON8CBDuAg8AwXXmXM9Jf-UUvApBy/exec', // Optional: separate chat endpoint
        };
        // ============================================

        function App() {
            const [activeTab, setActiveTab] = useState('leaderboard');
            const [data, setData] = useState(null);
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState(null);
            const [lastUpdate, setLastUpdate] = useState(null);
            const [chatMessages, setChatMessages] = useState([]);
            const [chatName, setChatName] = useState('');
            const [chatMessage, setChatMessage] = useState('');
            const [sortConfig, setSortConfig] = useState({ key: null, direction: 'asc' });
            const chatMessagesRef = useRef(null);

            // Fetch data from Google Sheets
            const fetchData = async () => {
                try {
                    const response = await fetch(CONFIG.SHEET_API_URL);
                    if (!response.ok) throw new Error('Failed to fetch data');
                    const result = await response.json();
                    setData(result);
                    setError(null);
                    setLastUpdate(new Date());
                    setLoading(false);
                } catch (err) {
                    console.error('Error fetching data:', err);
                    setError('Unable to connect to the dashboard. Please check your connection.');
                    setLoading(false);
                }
            };

            // Fetch chat messages
            const fetchChat = async () => {
                if (!CONFIG.CHAT_ENABLED) return;
                try {
                    const chatUrl = CONFIG.CHAT_SHEET_URL || CONFIG.SHEET_API_URL;
                    const response = await fetch(`${chatUrl}?type=chat`);
                    if (!response.ok) throw new Error('Failed to fetch chat');
                    const result = await response.json();
                    setChatMessages(result.messages || []);
                } catch (err) {
                    console.error('Error fetching chat:', err);
                }
            };

            // Send chat message
            const sendChatMessage = async () => {
                if (!chatName.trim() || !chatMessage.trim()) return;
                
                try {
                    const chatUrl = CONFIG.CHAT_SHEET_URL || CONFIG.SHEET_API_URL;
                    await fetch(chatUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            type: 'chat',
                            name: chatName.trim(),
                            message: chatMessage.trim(),
                        }),
                    });
                    setChatMessage('');
                    fetchChat();
                } catch (err) {
                    console.error('Error sending message:', err);
                }
            };

            // Initial data fetch
            useEffect(() => {
                fetchData();
                if (CONFIG.CHAT_ENABLED) fetchChat();
            }, []);

            // Auto-refresh data
            useEffect(() => {
                const interval = setInterval(() => {
                    fetchData();
                    if (CONFIG.CHAT_ENABLED) fetchChat();
                }, CONFIG.REFRESH_INTERVAL);

                return () => clearInterval(interval);
            }, []);

            // Auto-scroll chat to bottom
            useEffect(() => {
                if (chatMessagesRef.current) {
                    chatMessagesRef.current.scrollTop = chatMessagesRef.current.scrollHeight;
                }
            }, [chatMessages]);

            // Sorting function for full results table
            const handleSort = (key) => {
                let direction = 'asc';
                if (sortConfig.key === key && sortConfig.direction === 'asc') {
                    direction = 'desc';
                }
                setSortConfig({ key, direction });
            };

            const getSortedResults = () => {
                if (!data?.fullResults) return [];
                
                const sorted = [...data.fullResults];
                
                if (sortConfig.key === 'name') {
                    sorted.sort((a, b) => {
                        const comparison = a.name.localeCompare(b.name);
                        return sortConfig.direction === 'asc' ? comparison : -comparison;
                    });
                } else if (sortConfig.key === 'points') {
                    sorted.sort((a, b) => {
                        const comparison = (b.points || 0) - (a.points || 0);
                        return sortConfig.direction === 'asc' ? -comparison : comparison;
                    });
                }
                
                return sorted;
            };

            const getSortClass = (key) => {
                if (sortConfig.key !== key) return 'sortable';
                return sortConfig.direction === 'asc' ? 'sorted-asc' : 'sorted-desc';
            };

            if (loading) {
                return (
                    <div className="container">
                        <div className="loading">Loading dashboard...</div>
                    </div>
                );
            }

            if (error) {
                return (
                    <div className="container">
                        <div className="error">
                            <h2>‚ö†Ô∏è Connection Error</h2>
                            <p>{error}</p>
                            <p style={{marginTop: '10px', fontSize: '0.9rem'}}>
                                Make sure you've set up the Google Apps Script and updated the SHEET_API_URL in this file.
                            </p>
                        </div>
                    </div>
                );
            }

            return (
                <div className="container">
                    <div className="header">
                        <h1>
                            <img 
                                src="https://upload.wikimedia.org/wikipedia/en/8/8e/New_England_Patriots_logo.svg" 
                                alt="Patriots Logo" 
                                className="team-logo patriots"
                                onError={(e) => e.target.style.display = 'none'}
                            />
                            <span className="header-title-text">{data.title || '2026 Super Bowl LX Prop Bets'}</span>
                            <img 
                                src="https://upload.wikimedia.org/wikipedia/en/8/8e/Seattle_Seahawks_logo.svg" 
                                alt="Seahawks Logo" 
                                className="team-logo seahawks"
                                onError={(e) => e.target.style.display = 'none'}
                            />
                        </h1>
                        <div className="subtitle">Seahawks vs Patriots ‚Ä¢ Live Leaderboard</div>
                    </div>

                    <div className="stats-bar">
                        <div className="stat-card">
                            <div className="stat-label">üí∞ Prize Pool</div>
                            <div className="stat-value prize-value">${data.stats?.prizePool || 0}</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-label">‚úÖ Bets Completed</div>
                            <div className="stat-value">{data.stats?.completed || 0}</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-label">‚è≥ Bets Remaining</div>
                            <div className="stat-value">{data.stats?.remaining || 0}</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-label">üë• Total Entries</div>
                            <div className="stat-value">{data.stats?.totalEntries || 0}</div>
                        </div>
                    </div>

                    <div className="prize-section">
                        {data.prizes?.map((prize, idx) => (
                            <div key={idx} className="prize-card">
                                <div className="prize-place">{prize.place}</div>
                                <div className="prize-amount">${prize.amount}</div>
                                <div className="prize-winners">{prize.winners}</div>
                                
                                {prize.playerList && prize.playerList.length > 0 && (
                                    <div className="prize-tooltip">
                                        <div className="prize-tooltip-title">{prize.place} Winners</div>
                                        {prize.playerList.map((player, pIdx) => (
                                            <div key={pIdx} className="prize-tooltip-player">
                                                <span className="prize-tooltip-player-name">{player.name}</span>
                                                <span className="prize-tooltip-player-amount">${player.share}</span>
                                            </div>
                                        ))}
                                        <div className="prize-tooltip-total">
                                            <span className="prize-tooltip-total-label">Total Pool:</span>
                                            <span className="prize-tooltip-total-amount">${prize.amount}</span>
                                        </div>
                                    </div>
                                )}
                            </div>
                        ))}
                    </div>

                    <div className="tabs">
                        <button 
                            className={`tab ${activeTab === 'leaderboard' ? 'active' : ''}`}
                            onClick={() => setActiveTab('leaderboard')}
                        >
                            üèÜ Leaderboard
                        </button>
                        <button 
                            className={`tab ${activeTab === 'trends' ? 'active' : ''}`}
                            onClick={() => setActiveTab('trends')}
                        >
                            üìä Pick Trends
                        </button>
                        <button 
                            className={`tab ${activeTab === 'results' ? 'active' : ''}`}
                            onClick={() => setActiveTab('results')}
                        >
                            üìã Full Results
                        </button>
                        {CONFIG.CHAT_ENABLED && (
                            <button 
                                className={`tab ${activeTab === 'chat' ? 'active' : ''}`}
                                onClick={() => setActiveTab('chat')}
                            >
                                üí¨ Smack Talk
                            </button>
                        )}
                    </div>

                    {activeTab === 'leaderboard' && (
                        <div className="leaderboard">
                            <div className="leaderboard-header">
                                <div>Rank</div>
                                <div>Player</div>
                                <div>Points</div>
                                <div className="percentage">Accuracy</div>
                            </div>
                            {data.leaderboard?.map((player, idx) => (
                                <div key={idx} className="leaderboard-row">
                                    <div className={`rank rank-${player.rank}`}>{player.rank}</div>
                                    <div className="player-name">{player.name}</div>
                                    <div className="points">{player.points}</div>
                                    <div className="percentage">{player.percentage}</div>
                                </div>
                            ))}
                        </div>
                    )}

                    {activeTab === 'trends' && (
                        <div className="trends-grid">
                            {data.trends?.map((trend, idx) => (
                                <div key={idx} className="trend-card">
                                    <div className="trend-question">{trend.question}</div>
                                    {trend.options.map((option, optIdx) => (
                                        <div key={optIdx} className="trend-option">
                                            <div className="trend-label">
                                                <span className="trend-name">{option.name}</span>
                                                <span className="trend-percent">{option.percent}%</span>
                                            </div>
                                            <div className="trend-bar">
                                                <div 
                                                    className="trend-fill" 
                                                    style={{width: `${option.percent}%`}}
                                                ></div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            ))}
                        </div>
                    )}

                    {activeTab === 'results' && (
                        <div className="leaderboard">
                            <h2 style={{marginBottom: '20px', fontFamily: 'Oswald'}}>Full Results by Player</h2>
                            <div className="full-results-table">
                                <table className="results-table">
                                    <thead>
                                        <tr>
                                            <th 
                                                className={getSortClass('name')}
                                                onClick={() => handleSort('name')}
                                            >
                                                Player
                                            </th>
                                            <th 
                                                className={getSortClass('points')}
                                                onClick={() => handleSort('points')}
                                            >
                                                Points
                                            </th>
                                            {data.questions?.map((question, idx) => (
                                                <th key={idx}>
                                                    <div className="question-cell">
                                                        {idx + 1}
                                                        <div className="question-tooltip">
                                                            <div className="question-tooltip-title">{question}</div>
                                                            {data.results && data.results[idx] ? (
                                                                <div className="question-tooltip-result">
                                                                    <div className="question-tooltip-result-label">Result:</div>
                                                                    <div>{data.results[idx]}</div>
                                                                </div>
                                                            ) : (
                                                                <div className="question-tooltip-pending">
                                                                    Pending...
                                                                </div>
                                                            )}
                                                        </div>
                                                    </div>
                                                </th>
                                            ))}
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {getSortedResults().map((player, idx) => (
                                            <tr key={idx}>
                                                <td style={{fontWeight: 600}}>{player.name}</td>
                                                <td style={{fontWeight: 700, color: 'var(--accent-glow)'}}>{player.points}</td>
                                                {player.picks?.map((pick, pickIdx) => (
                                                    <td key={pickIdx} className={
                                                        pick.status === 'correct' ? 'correct-pick' :
                                                        pick.status === 'incorrect' ? 'incorrect-pick' :
                                                        'pending-pick'
                                                    }>
                                                        {pick.status === 'correct' ? '‚úì' :
                                                         pick.status === 'incorrect' ? '‚úó' : '‚àí'}
                                                    </td>
                                                ))}
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    )}

                    {activeTab === 'chat' && CONFIG.CHAT_ENABLED && (
                        <div className="chat-container">
                            <h2 style={{marginBottom: '20px', fontFamily: 'Oswald'}}>üí¨ Smack Talk Forum</h2>
                            <div className="chat-messages" ref={chatMessagesRef}>
                                {chatMessages.map((msg, idx) => (
                                    <div key={idx} className="chat-message">
                                        <div className="chat-author">{msg.name}</div>
                                        <div className="chat-text">{msg.message}</div>
                                        <div className="chat-time">{msg.time}</div>
                                    </div>
                                ))}
                                {chatMessages.length === 0 && (
                                    <div style={{textAlign: 'center', color: 'var(--text-secondary)', marginTop: '50px'}}>
                                        No messages yet. Be the first to talk some smack! üî•
                                    </div>
                                )}
                            </div>
                            <div className="chat-input-container">
                                <input
                                    type="text"
                                    className="chat-input"
                                    placeholder="Your name..."
                                    value={chatName}
                                    onChange={(e) => setChatName(e.target.value)}
                                    style={{flex: '0 0 150px'}}
                                />
                                <input
                                    type="text"
                                    className="chat-input"
                                    placeholder="Type your message..."
                                    value={chatMessage}
                                    onChange={(e) => setChatMessage(e.target.value)}
                                    onKeyPress={(e) => e.key === 'Enter' && sendChatMessage()}
                                />
                                <button className="chat-button" onClick={sendChatMessage}>
                                    Send
                                </button>
                            </div>
                        </div>
                    )}

                    {lastUpdate && (
                        <div className="update-indicator">
                            Last updated: {lastUpdate.toLocaleTimeString()}
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
